:root {
  --ace43-overscan: 0;
  --ace43-pan-x: 0px;
  --ace43-pan-y: 0px;
  --ace43-enabled: 0;
}

/* The fullscreen crop frame */
.ace-43-active .ace-43-frame {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  /* IMPORTANT: lower than YouTube controls so they stay visible */
  z-index: 10;
  background: #000;
  pointer-events: none; /* don't eat clicks */
}

.ace-43-active .ace-43-frame-inner {
  aspect-ratio: 4 / 3;
  width: min(100vw, calc(100vh * 4 / 3));
  height: min(calc(100vw * 3 / 4), 100vh);
  overflow: hidden;
  position: relative;
  pointer-events: none;
}

.ace-43-active .ace-43-video-wrap {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  pointer-events: none;
}

/* FORCE cover + size reset in fullscreen */
.ace-43-active .ace-43-video-wrap video {
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
  min-width: 100% !important;
  min-height: 100% !important;

  object-fit: cover !important;
  object-position: center center !important;

  transform:
    translate(var(--ace43-pan-x), var(--ace43-pan-y))
    scale(calc(1 + (var(--ace43-overscan) / 100))) !important;
  transform-origin: 50% 50% !important;
  pointer-events: auto;
}

/* Keep YouTube chrome/controls visible above our frame */
.ytp-chrome-top, .ytp-chrome-bottom, .ytp-gradient-bottom,
.ytp-gradient-top, .ytp-tooltip {
  z-index: 1000 !important;
}

/* Nuke some letterbox wrappers in fullscreen */
.ace-43-active .ytp-cinematic-container,
.ace-43-active .ytp-black-border {
  display: none !important;
}

.ace-43-active .html5-video-player,
.ace-43-active .html5-video-container {
  background: #000 !important;
}

/* ===== Non-fullscreen per-video panel ===== */
.ace43-panel-host {
  position: relative;
}

.ace43-panel {
  position: absolute;
  right: 12px;
  bottom: 12px;
  padding: 10px;
  border-radius: 10px;
  background: rgba(20,20,20,0.92);
  color: #fff;
  font: 12px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  box-shadow: 0 6px 24px rgba(0,0,0,0.35);
  backdrop-filter: blur(4px);
  min-width: 220px;
  z-index: 1002; /* above YT overlays in non-fullscreen */
}

.ace43-row { display: flex; align-items: center; gap: 8px; margin-top: 6px; }
.ace43-row label { min-width: 72px; color: #bbb; }
.ace43-panel input[type="number"] {
  width: 80px;
  background: #111;
  color: #fff;
  border: 1px solid #333;
  border-radius: 6px;
  padding: 4px 6px;
}

.ace43-btn {
  border: 1px solid #444;
  background: #222;
  color: #eee;
  padding: 6px 10px;
  border-radius: 8px;
  cursor: pointer;
}
.ace43-btn:hover { background:#2c2c2c; }

.ace43-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 6px;
  font-weight: 600;
}

.ace43-toggle {
  position: absolute;
  right: 12px;
  bottom: 12px;
  z-index: 1001;
  border-radius: 999px;
  background: rgba(20,20,20,0.92);
  color: #fff;
  border: 1px solid #333;
  padding: 6px 10px;
  cursor: pointer;
}

@media (max-width: 700px) {
  .ace43-panel { right: 6px; bottom: 6px; }
  .ace43-toggle { right: 6px; bottom: 6px; }
}